<?xml version="1.0" encoding="UTF-8"?>

<fc:composition xmlns="http://www.w3.org/1999/xhtml"
                template="WEB-INF/templates/principal.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="jakarta.faces.html"
                xmlns:fc="jakarta.faces.facelets"
                xmlns:f="jakarta.faces.core"
                xmlns:crud="jakarta.faces.composite/crud">

    <f:view>
        <f:metadata>
            <f:viewAction action="#{sesionUsuario.aplicarIdioma()}"/>
        </f:metadata>
    </f:view>

    <fc:define name="titulo">
        #{frmSala.titulo}
    </fc:define>

    <fc:define name="cuerpo">

        <h:panelGroup id="pnlGpDatos">
            <h:form>
                <h:panelGrid rendered="#{frmSala.estado == 'NINGUNO'}">
                    <p:dataTable id="tablaDatos" var="r" sortMode="single" paginatorPosition="bottom" reflow="true"
                                 paginator="true" rows="10" styleClass="dt-products" lazy="true"
                                 value="#{frmSala.modelo}"
                                 selection="#{frmSala.registro}"
                                 rowKey="#{r.idSala}">

                        <p:ajax event="rowSelect" update=":pnlGpDetalle :pnlGpDatos"
                                listener="#{frmSala.selecionarRegistro}" process="@this"/>

                        <p:column headerText="Id sala" sortBy="#{r.idSala}">
                            <h:outputText value="#{r.idSala}"/>
                        </p:column>
                        <p:column headerText="Sucursal" sortBy="#{r.idSucursal}">
                            <h:outputText value="#{r.idSucursal.nombre}"/>
                        </p:column>
                        <p:column headerText="Nombre" sortBy="#{r.nombre}">
                            <h:outputText value="#{r.nombre}"/>
                        </p:column>
                        <p:column headerText="Activo" sortBy="#{r.activo}">
                            <h:outputText value="#{r.activo}"/>
                        </p:column>
                        <p:column headerText="Observaciones" sortBy="#{r.observaciones}">
                            <h:outputText value="#{r.observaciones}"/>
                        </p:column>
                    </p:dataTable>
                    <crud:BtnTop frm="#{frmSala}"/>
                </h:panelGrid>
            </h:form>
        </h:panelGroup>

        <h:panelGroup id="pnlGpDetalle">
            <p:commandButton actionListener="#{frmSala.btnCancelarHandler}" value="#{abstractFrm['abstractFrm.cancel']}"
                             process="@this" update=":pnlGpDetalle :pnlGpDatos" action="#{sesionUsuario.aplicarIdioma}"
                             styleClass="ui-button-secondary" style="margin-right: .5rem" icon="pi pi-times-circle" rendered="#{frmSala.estado=='MODIFICAR'}"/>
            <p:tabView id="tabDetalle" cache="false" rendered="#{frmSala.estado!='NINGUNO'}" dynamic="true">

                <p:ajax process="@this" event="tabChange" listener="#{frmSala.cambiarTab}"/>

                <p:tab title="Detalle" closable="false">
                    <h:panelGrid>
                        <h:form id="frmDetalle" rendered="#{frmSala.estado!='NINGUNO'}">
                            <h:panelGrid columns="2">
                                <h:outputLabel value="Id Sala" for="txtIdSala"/>
                                <h:inputText id="txtIdSala" value="#{frmSala.registro.idSala}" readonly="true" disabled="true"/>
                                <h:outputLabel value="Nombre" for="txtNombre"/>
                                <h:inputText  id="txtNombre" value="#{frmSala.registro.nombre}" required="true"/>
                                <h:outputText value="Sucursa" for="sucursalList"/>
                                <p:selectOneMenu id="sucursalList" value="#{frmSala.idSucursalSeleccionado}">
                                    <f:selectItems value="#{frmSala.sucursalList}" var="s"
                                                    itemLabel="#{s.nombre}" itemValue="#{s.idSucursal}"/>
                                </p:selectOneMenu>
                                <h:outputLabel value="Activo" for="txtActivo"/>
                                <h:selectBooleanCheckbox id="txtActivo" value="#{frmSala.registro.activo}"/>
                                <h:outputLabel value="Observaciones" for="txtObservaciones"/>
                                <h:inputTextarea size="50" id="txtObservaciones" value="#{frmSala.registro.observaciones}"/>
                            </h:panelGrid>
                            <h:panelGrid>
                                <crud:BtnTop frm="#{frmSala}"/>
                            </h:panelGrid>
                        </h:form>
                    </h:panelGrid>
                </p:tab>

                <p:tab title="Caracteristicas" disabled="#{frmSala.estado!='MODIFICAR'}" closable="false">
                    <h:panelGroup id="tiposPnlGpDatos">
                        <h:form>
                            <h:panelGrid rendered="#{frmSala.frmSalaCaracteristica.estado == 'NINGUNO'}">
                                <p:dataTable id="tiposTablaDatos" var="r" value="#{frmSala.frmSalaCaracteristica.modelo}"
                                             sortMode="single" selection="#{frmSala.frmSalaCaracteristica.registro}"
                                             paginatorPosition="bottom" reflow="true" rowKey="#{r.idSalaCaracteristica}"
                                             paginator="true" rows="10" styleClass="dt-products" lazy="true">

                                    <p:ajax event="rowSelect" update="tabDetalle:tiposPnlGpDatos tabDetalle:tiposPnlGpDetalle" process="@this"
                                            listener="#{frmSala.frmSalaCaracteristica.selecionarRegistro}"/>

                                    <p:column headerText="Id Caracteristica Sala" sortBy="#{r.idSalaCaracteristica}">
                                        <h:outputText value="#{r.idSalaCaracteristica}"/>
                                    </p:column>
                                    <p:column headerText="Id Tipo" sortBy="#{r.idTipoSala.idTipoSala}">
                                        <h:outputText value="#{r.idTipoSala.idTipoSala}"/>
                                    </p:column>
                                    <p:column headerText="Id Sala" sortBy="#{r.idSala.idSala}">
                                        <h:outputText value="#{r.idSala.idSala}"/>
                                    </p:column>
                                    <p:column headerText="Valor" sortBy="#{r.valor}">
                                        <h:outputText value="#{r.valor}"/>
                                    </p:column>
                                </p:dataTable>
                            </h:panelGrid>
                        </h:form>
                    </h:panelGroup>

                    <h:panelGroup id="tiposPnlGpDetalle">
                            <h:form>
                                <h:panelGroup>
                                    <h:panelGrid columns="2" rendered="#{frmSala.frmSalaCaracteristica.estado!='NINGUNO'}">
                                        <h:outputLabel value="Id Sala" for="tiposTxtIdSala"/>
                                         <h:inputText id="tiposTxtIdSala" value="#{frmSala.frmSalaCaracteristica.registro.idSala.idSala}" readonly="true" disabled="true"/>
                                        <h:outputLabel value="Id Caracteristica" for="tiposTxtIdCaracteristicas"/>
                                        <h:inputText id="tiposTxtIdCaracteristicas" value="#{frmSala.frmSalaCaracteristica.registro.idSalaCaracteristica}" readonly="true" disabled="true"/>
                                        <h:outputLabel value="Tipos de Sala" for="listTipoSala"/>
                                        <p:selectOneMenu id="listTipoSala" value="#{frmSala.frmSalaCaracteristica.idTipoSalaSeleccionado}">
                                            <f:selectItems value="#{frmSala.frmSalaCaracteristica.tipoSalaList}" var="tp"
                                                            itemValue="#{tp.idTipoSala}" itemLabel="#{tp.nombre}"/>
                                            <p:ajax event="change" execute="@this" update="tiposTxtValor"/>
                                        </p:selectOneMenu>
                                        <p:outputLabel value="Valor" for="tiposTxtValor"/>
                                        <p:inputTextarea id="tiposTxtValor" validator="#{frmSala.frmSalaCaracteristica.validarVailador}"
                                                         value="#{frmSala.frmSalaCaracteristica.registro.valor}"/>
                                    </h:panelGrid>
                                    <h:panelGrid>
                                        <crud:BtnTop frm="#{frmSala.frmSalaCaracteristica}" actualizar="tabDetalle:tiposPnlGpDetalle tabDetalle:tiposPnlGpDatos"/>
                                    </h:panelGrid>
                                </h:panelGroup>
                            </h:form>
                    </h:panelGroup>
                </p:tab>

                <p:tab title="Asientos" closable="false" disabled="#{frmSala.estado!='MODIFICAR'}">
                    <h:panelGroup id="asientosPnlGpDatos">
                        <h:form>
                            <h:panelGrid rendered="#{frmSala.frmAsiento.estado=='NINGUNO'}">
                                <p:dataTable id="AsientosDatos" reflow="true" sortMode="single" var="r"
                                             paginator="true" rows="10" styleClass="dt-products" lazy="true" paginatorPosition="bottom"
                                             value="#{frmSala.frmAsiento.modelo}" selection="#{frmSala.frmAsiento.registro}" rowKey="#{r.idAsiento}">

                                    <p:ajax event="rowSelect" update="tabDetalle:asientosPnlGpDatos tabDetalle:asientosPnlGpDetalle" listener="#{frmSala.frmAsiento.selecionarRegistro()}"/>

                                    <p:column headerText="Id Asiento" sortBy="#{r.idAsiento}">
                                        <h:outputText value="#{r.idAsiento}"/>
                                    </p:column>
                                    <p:column headerText="Id Sala" sortBy="#{r.idSala}">
                                        <h:outputText value="#{r.idSala.idSala}"/>
                                    </p:column>
                                    <p:column headerText="Nombre" sortBy="#{r.nombre}">
                                        <h:outputText value="#{r.nombre}" />
                                    </p:column>
                                    <p:column headerText="Activo" sortBy="#{r.activo}">
                                        <h:outputText value="#{r.activo}"/>
                                    </p:column>
                                </p:dataTable>
                            </h:panelGrid>
                        </h:form>
                    </h:panelGroup>

                    <h:panelGroup id="asientosPnlGpDetalle">
                        <h:form>
                            <h:panelGroup id="asientosPnlGpDetalles">
                                <h:panelGrid columns="2" rendered="#{frmSala.frmAsiento.estado != 'NINGUNO'}">
                                    <h:outputText value="Id Sala" for="asientoTxtIdSala"/>
                                    <h:inputText id="asientoTxtIdSala" value="#{frmSala.frmAsiento.registro.idSala.idSala}" readonly="true" disabled="true"/>
                                    <h:outputText value="Id Asiento" for="asientosTxtId"/>
                                    <h:inputText id="asientosTxtId" value="#{frmSala.frmAsiento.registro.idAsiento}" readonly="true" disabled="true"/>
                                    <h:outputText value="Nombre" for="asientosTxtNomnbre"/>
                                    <h:inputText id="asientosTxtNomnbre" value="#{frmSala.frmAsiento.registro.nombre}"/>
                                </h:panelGrid>

                                <h:panelGrid>
                                    <crud:BtnTop frm="#{frmSala.frmAsiento}" actualizar="tabDetalle:asientosPnlGpDetalle tabDetalle:asientosPnlGpDatos"/>
                                </h:panelGrid>
                            </h:panelGroup>

                            <h:panelGroup id="asientosCaracteristicasPnlGplist" rendered="#{frmSala.frmAsiento.estado == 'MODIFICAR'}">
                                <h:panelGrid columns="2" rendered="#{frmSala.frmAsiento.frmAsientoCaracteristica.estado != 'CREAR'}">
                                    <h:outputText value="Caracteristicas" for="tipoAsientoList" />
                                    <p:selectOneListbox id="tipoAsientoList" value="#{frmSala.frmAsiento.frmAsientoCaracteristica.caracteristicaByTipo}">
                                        <f:selectItems value="#{frmSala.frmAsiento.frmAsientoCaracteristica.caracteristicasAsiento}" var="r"
                                                       itemLabel="#{r.idTipoAsiento.nombre}" itemValue="#{r.idTipoAsiento.idTipoAsiento}"/>
                                        <p:ajax event="change" listener="#{frmSala.frmAsiento.frmAsientoCaracteristica.selecionarRegistro}"
                                                process="@this" update="tabDetalle:asientosPnlGpDetalle"/>
                                    </p:selectOneListbox>
                                </h:panelGrid>
                                <h:panelGrid>
                                    <crud:BtnTop frm="#{frmSala.frmAsiento.frmAsientoCaracteristica}" actualizar="tabDetalle:asientosPnlGpDetalle"/>
                                </h:panelGrid>
                            </h:panelGroup>

                            <h:panelGrid columns="2" id="tipoAsientoDetalle" rendered="#{frmSala.frmAsiento.frmAsientoCaracteristica.estado !='NINGUNO'}">
                                <h:outputText value="Id Caracteristica" for="asientoCaracteristicaTxtId"/>
                                <h:inputText id="asientoCaracteristicaTxtId" value="#{frmSala.frmAsiento.frmAsientoCaracteristica.registro.idAsientoCaracteristica}" disabled="true" readonly="true"/>
                                <h:outputText value="Id Tipo" for="asientoTxtId"
                                              rendered="#{frmSala.frmAsiento.frmAsientoCaracteristica.estado == 'MODIFICAR'}"
                                              style="#{frmSala.frmAsiento.frmAsientoCaracteristica.estado == 'MODIFICAR'? '' : 'display: none;'}"/>
                                <h:inputText id="asientoTxtId" readonly="true" disabled="true"
                                             value="#{frmSala.frmAsiento.frmAsientoCaracteristica.registro.idTipoAsiento.idTipoAsiento}"
                                             rendered="#{frmSala.frmAsiento.frmAsientoCaracteristica.estado == 'MODIFICAR'}"
                                             style="#{frmSala.frmAsiento.frmAsientoCaracteristica.estado == 'MODIFICAR'? '' : 'display: none;'}"/>

                                <h:outputText value="Caracteristica" for="tipoAsientoList"
                                              rendered="#{frmSala.frmAsiento.frmAsientoCaracteristica.estado == 'CREAR'}"
                                              style="#{frmSala.frmAsiento.frmAsientoCaracteristica.estado == 'CREAR'? '' : 'display: none;'}"/>
                                <p:selectOneMenu id="tiposAsientosList" value="#{frmSala.frmAsiento.frmAsientoCaracteristica.idTipoAsientoSeleccionado}"
                                                 rendered="#{frmSala.frmAsiento.frmAsientoCaracteristica.estado == 'CREAR'}"
                                                 style="#{frmSala.frmAsiento.frmAsientoCaracteristica.estado == 'CREAR'? '' : 'display: none;'}">
                                    <f:selectItems value="#{frmSala.frmAsiento.frmAsientoCaracteristica.tipoAsientoList}" var="r" itemValue="#{r.idTipoAsiento}" itemLabel="#{r.nombre}"/>
                                </p:selectOneMenu>
                                <h:outputText value="Valor" for="asientoCaracteristicaTxtValor"/>
                                <h:inputTextarea id="asientoCaracteristicaTxtValor" value="#{frmSala.frmAsiento.frmAsientoCaracteristica.registro.valor}" validator="#{frmSala.frmAsiento.frmAsientoCaracteristica.validarVailador}"/>
                            </h:panelGrid>
                        </h:form>
                    </h:panelGroup>
                </p:tab>

                <p:tab title="Programacion" disabled="#{frmSala.estado!='MODIFICAR'}">
                    <h:panelGroup id="CalendarioProgramacion">
                        <h:form>
                            <h:panelGrid rendered="#{frmSala.frmProgramacion.salaSeleccionada!=null}">
                                <p:schedule value="#{frmSala.frmProgramacion.programacionModel}"/>
                            </h:panelGrid>
<!--                            <p:dialog widgetVar="eventoDialogo" id="eventoDialogo" header="Agregar Programacion" modal="true" draggable="false" resizable="false">-->
<!--                                <h:panelGrid columns="2">-->
<!--                                    <h:outputText value="Id" for="prnId"/>-->
<!--                                    <h:inputText id="prnId" value="#{frmSala.frmProgramacion.registro.idSala}" readonly="true" disabled="true"/>-->
<!--                                    <h:outputText value="Pelicula" for="prnPelicula"/>-->
<!--                                    <h:inputText id="prnPelicula" value="#{frmSala.frmProgramacion.registro.idPelicula.nombre}"/>-->
<!--                                    <h:outputText value="Desde" for="prnDesde"/>-->
<!--                                    <h:inputText id="prnDesde" value="#{frmSala.frmProgramacion.registro.desde}"/>-->
<!--                                    <h:outputText value="Hasta" for="prnHasta"/>-->
<!--                                    <h:inputText id="prnHasta" value="#{frmSala.frmProgramacion.registro.hasta}"/>-->
<!--                                </h:panelGrid>-->
<!--                                <p:commandButton value="#{abstractFrm['abstractFrm.create']}"-->
<!--                                                 process="@this" update="tabDetalle:calendarioProgramacion" actionListener="#{frmSala.frmProgramacion.btnGuardarHandler}"-->
<!--                                                 styleClass="ui-button-success" style="margin-right: .5rem" con="pi pi-save" oncomplete="PF('eventoDialogo').hide())"/>-->
<!--                                </p:dialog>-->
                        </h:form>
                    </h:panelGroup>
                </p:tab>

            </p:tabView>
        </h:panelGroup>

    </fc:define>
</fc:composition>