<?xml version="1.0" encoding="UTF-8"?>

<f:composition xmlns="http://www.w3.org/1999/xhtml"
               xmlns:p="http://primefaces.org/ui"
               xmlns:h="jakarta.faces.html"
               xmlns:f="jakarta.faces.facelets"
               template="WEB-INF/templates/principal.xhtml"
               xmlns:c="jakarta.faces.core"
               xmlns:crud="jakarta.faces.composite/crud"
               xmlns:datos="jakarta.faces.composite/datos">

    <f:define name="titulo">
        #{frmReserva.titulo}
    </f:define>

    <f:define name="cuerpo">

        <h:form id="reservaFrm">

            <p:growl id="growl" sticky="true" showDetail="true"/>

            <p:wizard id="reservaWizard" flowListener="#{reservaWizardBean.onFlowProcess}" widgetVar="wizard">
                <!-- Ejemplo-->
                <p:tab id="Indicaciones" title="Indicaciones">
                    <p:panel>
                        <p:messages/>
                        <p:panelGrid columns="1">
                            <h:outputText value="Bienvenido al asistente para crear un nuevo registro de Reserva."/>
                            <h:outputText value="Ingrese todos los datos solicitados incluyendo los asientos y al final guarde su reserva."/>
                        </p:panelGrid>
                    </p:panel>
                </p:tab>

                <!-- Paso 1: Fecha y Tipo de Reserva, formato de fecha offsetDataTime no compatible -->
                <!-- 2024-09-19 20:26:00+00-->
                <p:tab id="fechaStep" title="Fecha">
                    <p:panel header="Seleccionar Fecha">
                        <p:messages/>
                        <h:panelGrid columns="2">
                            <h:outputText value="Seleccione día: *"/>
                            <p:calendar value="#{reservaWizardBean.fechaReservaSeleccionada}"
                                        label="Seleccione un día" required="true"
                                        requiredMessage="Seleccione una fecha válida!!"
                                        pattern="yyyy-MM-dd" showButtonPanel="true"
                                        mindate="#{reservaWizardBean.minDate}"/>
                            <h:outputText value="Tipo de Reserva: *"/>
                            <p:selectOneMenu id="tipoReservaOption"
                                             value="#{reservaWizardBean.idTipoReservaSeleccionado}"
                                             required="" requiredMessage="Debe Seleccionar un Tipo de Reserva">
                                <c:selectItems value="#{frmReserva.tiposReserva}"
                                               var="tr"
                                               itemLabel="#{tr.nombre}"
                                               itemValue="#{tr.idTipoReserva}"/>
                            </p:selectOneMenu>
                        </h:panelGrid>
                    </p:panel>
                </p:tab>

                <!-- Paso 2: Seleccionar una programción -->
                <p:tab id="funcionStep" title="Función">
                    <p:panel header="Seleccionar Función">
                        <p:messages/>
                        <h:panelGrid columns="2" columnClasses="label, value">
                            <h:outputText value="Fecha Selecionada en Wizard: "/>
                            <h:outputText value="#{reservaWizardBean.fechaReservaSeleccionada}"/>
                            <h:outputText value="Fecha Guardada en registro: "/>
                            <h:outputText value="#{frmReserva.registro.fechaReserva}"/>
                            <h:outputText value="Tipo Reserva guardada en registro: "/>
                            <h:outputText value="#{frmReserva.registro.idTipoReserva.nombre}"/>
                            <h:outputText value="Observaciones Default: "/>
                            <h:outputText value="#{frmReserva.registro.observaciones}"/>
                            <h:outputText value="Estado Default: "/>
                            <h:outputText value="#{frmReserva.registro.estado}"/>

                            <h:outputText value="Seleccione función: "/>
                            <p:selectOneMenu id="programacionOption" value="#{reservaWizardBean.idProgramacionSeleccionada}">
                                <c:selectItems value="#{frmProgramacion.programacionesDelDia}" var="prn"
                                               itemLabel="#{prn.idPelicula.nombre}, #{prn.idSala.nombre}, #{prn.idSala.idSucursal.nombre}, (#{prn.desde} - #{prn.hasta})"
                                               itemValue="#{prn.idProgramacion}" />
                            </p:selectOneMenu>
                        </h:panelGrid>

                        <h:panelGrid id="sinopsisPanel" columns="1">
                            <h:outputText value="Sinopsis: "/>
                            <!--h:outputText value="#{prn.idPelicula.sinopsis}"/-->
                            <h:outputText value="Características:"/>
                            <!--h:outputText value="#{prn.idPelicula.peliculaCaracteristicasList}"/-->
                        </h:panelGrid>
                    </p:panel>
                </p:tab>


                <p:tab id="asientosStep" title="Asientos">
                    <p:panel header="Asientos">
                        <p:messages/>
                        <h:panelGrid columns="2" columnClasses="label, value">
                            <h:outputText value="Fecha Selecionada en Wizard: "/>
                            <h:outputText value="#{reservaWizardBean.fechaReservaSeleccionada}"/>
                            <h:outputText value="Fecha Guardada en registro: "/>
                            <h:outputText value="#{frmReserva.registro.fechaReserva}"/>
                            <h:outputText value="Tipo Reserva guardada en registro: "/>
                            <h:outputText value="#{frmReserva.registro.idTipoReserva.nombre}"/>
                            <h:outputText value="Observaciones Default: "/>
                            <h:outputText value="#{frmReserva.registro.observaciones}"/>
                            <h:outputText value="Estado Default: "/>
                            <h:outputText value="#{frmReserva.registro.estado}"/>
                            <h:outputText value="Programación en el registro"/>
                            <h:outputText value="#{frmReserva.registro.idProgramacion.idProgramacion}"/>

                        </h:panelGrid>
                        <p:panelGrid columns="3">
                            <p:selectOneMenu id="asientosOption" value="#{reservaWizardBean.asientosSeleccionados}">
                                <c:selectItems value="#{frmAsiento.asientosDisponibles}" var="a"
                                               itemLabel="#{a.nombre}"
                                               itemValue="#{a.idAsiento}" />
                            </p:selectOneMenu>
                        </p:panelGrid>

                    </p:panel>
                </p:tab>

                <p:tab id="confirm" title="Confirmation">
                    <p:panel header="Confirmation">
                        <h:panelGrid id="confirmation" columns="3" columnClasses="grid,grid,grid">

                        </h:panelGrid>

                        <p:commandButton value="Submit" action="#{reservaWizardBean.save}" update="growl" process="@form"/>
                    </p:panel>
                </p:tab>
            </p:wizard>
        </h:form>
    </f:define>


</f:composition>